<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Opus 1 Integration Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #1a1a1a;
            color: #ffffff;
        }
        .card-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .card {
            border: 2px solid #444;
            border-radius: 8px;
            padding: 10px;
            background: #2a2a2a;
            text-align: center;
        }
        .card img {
            width: 100%;
            max-width: 180px;
            height: auto;
            border-radius: 4px;
        }
        .card.has-real-image {
            border-color: #44ff44;
        }
        .card.placeholder-image {
            border-color: #ffaa44;
        }
        .stats {
            background: #333;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .test-controls {
            text-align: center;
            margin: 20px 0;
        }
        button {
            padding: 10px 20px;
            margin: 0 10px;
            font-size: 16px;
            background: #0066cc;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background: #0088ff;
        }
    </style>
</head>
<body>
    <h1>üÉè Opus 1 Integration Test</h1>
    <p>Testing the integration of actual Opus 1 card images with the card database.</p>
    
    <div class="test-controls">
        <button onclick="loadEnhancedDatabase()">Load Enhanced Database</button>
        <button onclick="loadOpus1Only()">Load Opus 1 Only</button>
        <button onclick="showStats()">Show Statistics</button>
        <button onclick="clearGallery()">Clear Gallery</button>
    </div>
    
    <div id="stats" class="stats">
        <p>Click "Load Enhanced Database" to see the integration results.</p>
    </div>
    
    <div id="cardGallery" class="card-gallery">
        <!-- Cards will be loaded here -->
    </div>

    <script type="module">
        import { getEnhancedCardDatabase, getOpus1CardDatabase } from './js/data/ExtendedCardDatabase.js';
        
        let currentDatabase = [];
        
        window.loadEnhancedDatabase = async function() {
            try {
                currentDatabase = getEnhancedCardDatabase();
                displayCards(currentDatabase.slice(0, 20)); // Show first 20 cards
                updateStats();
                console.log('Enhanced database loaded:', currentDatabase.length, 'cards');
            } catch (error) {
                console.error('Error loading enhanced database:', error);
                document.getElementById('stats').innerHTML = `<p style="color: #ff4444;">Error: ${error.message}</p>`;
            }
        };
        
        window.loadOpus1Only = async function() {
            try {
                currentDatabase = getOpus1CardDatabase();
                displayCards(currentDatabase.slice(0, 20)); // Show first 20 cards
                updateStats();
                console.log('Opus 1 database loaded:', currentDatabase.length, 'cards');
            } catch (error) {
                console.error('Error loading Opus 1 database:', error);
                document.getElementById('stats').innerHTML = `<p style="color: #ff4444;">Error: ${error.message}</p>`;
            }
        };
        
        window.showStats = function() {
            updateStats();
        };
        
        window.clearGallery = function() {
            document.getElementById('cardGallery').innerHTML = '';
            document.getElementById('stats').innerHTML = '<p>Gallery cleared.</p>';
        };
        
        function displayCards(cards) {
            const gallery = document.getElementById('cardGallery');
            gallery.innerHTML = '';
            
            cards.forEach(card => {
                const cardDiv = document.createElement('div');
                cardDiv.className = `card ${card.hasRealImage ? 'has-real-image' : 'placeholder-image'}`;
                
                cardDiv.innerHTML = `
                    <img src="${card.image}" alt="${card.name}" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjI4MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjI4MCIgZmlsbD0iIzMzMyIvPjx0ZXh0IHg9IjEwMCIgeT0iMTQwIiBmaWxsPSJ3aGl0ZSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjE0Ij5JbWFnZSBOb3QgRm91bmQ8L3RleHQ+PC9zdmc+'" />
                    <h3>${card.name}</h3>
                    <p><strong>Element:</strong> ${card.element}</p>
                    <p><strong>Type:</strong> ${card.type}</p>
                    <p><strong>Cost:</strong> ${card.cost}</p>
                    ${card.power ? `<p><strong>Power:</strong> ${card.power}</p>` : ''}
                    <p><strong>Rarity:</strong> ${card.rarity}</p>
                    <p><strong>Real Image:</strong> ${card.hasRealImage ? '‚úÖ Yes' : '‚ùå No'}</p>
                    <p><small>ID: ${card.id}</small></p>
                `;
                
                gallery.appendChild(cardDiv);
            });
        }
        
        function updateStats() {
            if (currentDatabase.length === 0) {
                document.getElementById('stats').innerHTML = '<p>No database loaded.</p>';
                return;
            }
            
            const totalCards = currentDatabase.length;
            const realImages = currentDatabase.filter(c => c.hasRealImage).length;
            const placeholderImages = totalCards - realImages;
            
            const elementCounts = {};
            const typeCounts = {};
            const rarityCounts = {};
            
            currentDatabase.forEach(card => {
                elementCounts[card.element] = (elementCounts[card.element] || 0) + 1;
                typeCounts[card.type] = (typeCounts[card.type] || 0) + 1;
                rarityCounts[card.rarity] = (rarityCounts[card.rarity] || 0) + 1;
            });
            
            const statsHTML = `
                <h3>üìä Database Statistics</h3>
                <p><strong>Total Cards:</strong> ${totalCards}</p>
                <p><strong>Real Images:</strong> ${realImages} (${Math.round((realImages/totalCards)*100)}%)</p>
                <p><strong>Placeholder Images:</strong> ${placeholderImages} (${Math.round((placeholderImages/totalCards)*100)}%)</p>
                
                <h4>By Element:</h4>
                <p>${Object.entries(elementCounts).map(([element, count]) => `${element}: ${count}`).join(', ')}</p>
                
                <h4>By Type:</h4>
                <p>${Object.entries(typeCounts).map(([type, count]) => `${type}: ${count}`).join(', ')}</p>
                
                <h4>By Rarity:</h4>
                <p>${Object.entries(rarityCounts).map(([rarity, count]) => `${rarity}: ${count}`).join(', ')}</p>
                
                <p><small>Showing first 20 cards in gallery. Check console for full database.</small></p>
            `;
            
            document.getElementById('stats').innerHTML = statsHTML;
        }
        
        // Auto-load enhanced database on page load
        setTimeout(() => {
            loadEnhancedDatabase();
        }, 1000);
    </script>
</body>
</html>